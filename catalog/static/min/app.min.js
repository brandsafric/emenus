$(function(){"use strict";$("#appetizer-section").click(function(){$("#appetizer-row").slideToggle(),$("#appetizer-toggle").hasClass("fa-chevron-up")?($("#appetizer-toggle").toggleClass("fa-chevron-up"),$("#appetizer-toggle").toggleClass("fa-chevron-down")):($("#appetizer-toggle").toggleClass("fa-chevron-down"),$("#appetizer-toggle").toggleClass("fa-chevron-up"))}),$("#entree-section").click(function(){$("#entree-row").slideToggle(),$("#entree-toggle").hasClass("fa-chevron-up")?($("#entree-toggle").toggleClass("fa-chevron-up"),$("#entree-toggle").toggleClass("fa-chevron-down")):($("#entree-toggle").toggleClass("fa-chevron-down"),$("#entree-toggle").toggleClass("fa-chevron-up"))}),$("#dessert-section").click(function(){$("#dessert-row").slideToggle(),$("#dessert-toggle").hasClass("fa-chevron-up")?($("#dessert-toggle").toggleClass("fa-chevron-up"),$("#dessert-toggle").toggleClass("fa-chevron-down")):($("#dessert-toggle").toggleClass("fa-chevron-down"),$("#dessert-toggle").toggleClass("fa-chevron-up"))}),$("#beverage-section").click(function(){$("#beverage-row").slideToggle(),$("#beverage-toggle").hasClass("fa-chevron-up")?($("#beverage-toggle").toggleClass("fa-chevron-up"),$("#beverage-toggle").toggleClass("fa-chevron-down")):($("#beverage-toggle").toggleClass("fa-chevron-down"),$("#beverage-toggle").toggleClass("fa-chevron-up"))}),$("#icon-sort").click(function(){sortListDir()}),($("#editRestForm").length||$("#newRestForm").length)&&function(){var e,t,a,s=$(".img_tn"),l=[],n=$("#img_tn_1").attr("src");s.map(function(e,t){$(this).attr("data-fn")&&l.push($(this).attr("data-fn"))}),e=$("#newRestForm").length?1:$(".img_thumbnail.selected").attr("data-index"),$(".img_thumbnail").click(function(){g()}),$(".i_delete").click(function(e){$(e.target).hasClass("icon_show")&&r()}),$(".btn-set").on("click",function(){var t="/../var/www/html/itemcatalog/static/"+$("#img_tn_"+e).attr("data-imgpath");t||(t=$("#image_tn_1").attr("data-imgpath")),$("#rest_img").attr("src",t)}),$("#upload").change(function(s){var n=this.files[0];if(n.size/1024>1024)alert("Sorry the file exceeds the maximum size of 1 MB!"),$("#upload").val("");else if(i(n.name))$("#upload").val(""),alert("File is already uploaded!");else{$(".file_container").css("display","none");var d=new FormData;d.append("image",n,n.name),$.ajax({url:"/uploadImage",data:d,processData:!1,contentType:!1,type:"POST",success:function(s){$("#upload").val(""),$(".file_container").css("display","block");var i=JSON.parse(s);if("status"in i&&"OK"==i.status){var d=i.index,h=i.path,_='<li class="img_thumbnail selected" id="img_thumbnail_%data%" data-index="%data%" ><img id="img_tn_%data%" class="img_tn img_tn_ul" data-imgpath="%path%" data-index="%data%" src="" alt="img"></li>'.replace(/%data%/g,d).replace(/%path%/g,h);$(".img_gallery").append(_);var p=$(".img_tn_ul").last(),u=new FileReader;u.readAsDataURL(n),$("#img_thumbnail_"+d).click(function(){g()}),$("#btn-set").removeAttr("disabled"),$("#i_delete_"+d).toggleClass("icon_show");var v='<div class="icons_delete" id="icons_delete_%data%" data-index="%data%"><i id="i_delete_%data%" data-index="%data%" data-tn="img_thumbnail_%data%" data-parent="icons_delete_%data%" class="fa fa-times-circle i_delete icon_show" aria-hidden="true"></i></div>'.replace(/%data%/g,d);$(".image_container").append(v),$("#i_delete_"+d).click(function(e){r()}),$("#target").val(d),u.onloadend=function(){p.attr("src",u.result),l.push(n),e!=d&&(t=$("#img_thumbnail_"+e),a=$("#i_delete_"+e),c(t,a),t.hasClass("selected")&&t.toggleClass("selected"),a.hasClass("icon_show")&&a.toggleClass("icon_show"),e=d),o()}}},error:function(e){console.log(e)}})}});var i=function(e){return-1!=l.indexOf(e)},o=function(){l.length&&l.length>=5&&($(".file_container").css("display","none"),$(".no_upload").css("display","block"))},r=function(){var e="#"+$(event.target).attr("data-parent"),t=$(event.target).attr("data-index"),a="#"+$(event.target).attr("data-tn"),s=$(event.target).attr("data-fn"),i=$(event.target).attr("data-imgpath"),o=$(a),r=$(e),g={image_index:t};$.ajax({url:"/deleteImage",contentType:"application/json",data:JSON.stringify(g),dataType:"json",type:"POST",success:function(e){$(r).remove(),$(o).remove();var t=l.indexOf(s);t>-1&&l.splice(t,1),$(".file_container").css("display","block"),$(".no_upload").css("display","none"),"#rest_img".src!=i&&"#rest_img".src!=s||($("#rest_img").attr("src",n),$("#btn-set").attr("disabled","disabled"),$("#target").val(1))},error:function(e){console.log(e),console.log("Error. Cannot Remove image from DOM.")}})},g=function(){var t,a;if($(event.target).hasClass("img_thumbnail"))if($(event.target).hasClass("selected"));else{d(event.target),$(event.target).toggleClass("selected");var s=$("#i_delete_"+e);s.hasClass("i_delete")&&s.toggleClass("icon_show"),$("#target").children().val(""),$("#btn-set").removeAttr("disabled")}else if($(event.target).parent().hasClass("selected"));else{d(event.target),t=$("#img_thumbnail_"+e),a=$("#i_delete_"+e),c(t,"selected",1),c(a,"icon_show",1);var l=t.children().attr("data-index");$("#target").val(l),$("#btn-set").removeAttr("disabled")}},c=function(e,t,a){a?e.not(t)&&e.toggleClass(t):e.hasClass(t)&&e.toggleClass(t)},d=function(s){t=$("#img_thumbnail_"+e),a=$("#i_delete_"+e),c(t,"selected",0),c(a,"icon_show",0),e=$(s).attr("data-index")};o()}()});